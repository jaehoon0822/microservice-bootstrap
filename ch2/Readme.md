# CH2

## 개발원칙

이 책에서 말하는 가장 중요한 개념이다.
이 책에서는 다음처럼 이야기한다.

- 단계적 반복

> 조금씩 빠르게 코드를 더해가는 것은 생산적인 개발의 필수적이다.

- 항상 동작하게 유지

> 각 반복 작업에서 생상된 코드는 잘 동작하는 테스트된 코드여야 한다. 이렇게 생상된 일련의 코드는 크고 견고하다.

- 단순함으로부터 출발

> 복잡성은 언젠가 앱이 결국 도달하게 되는 상태지만, 처음부터 그럴필요는 없다.  
> 코드 변경단위는 간단하게 만들면서 하나의 반복 단계에서는 지나친 복잡함을 피하도록 하자.

이 같은 설명을 하며 다음처럼 이야기한다.

> 복잡한 앱에서 생기는 문제를 해결하려면, 앱에서 문제점을 추출해내고  
> 비교적 간단한 환경에서 재현해보는것을 두려워하지 말자.  
> 다 작은 범위의 코드 안에서 문제를 격리할 수 있다면, 문제가 숨을수 있는  
> 공간도 줄어들 것이다.

함수형 자바스크립트에서 최대한 잘게 쪼개서 함수로 만들면  
프로그래밍할때 도움이 된다고 했던거 같은데, 비슷한 맥락인것 처럼  
보인다.

복잡한 문제를 만나면 각 부분을 잘게 쪼개고, 작은 문제로 만들어 나가라고  
알려주는 듯하다.

이 책에서 마음에 들었던 부분은 다음과 같다

```sh

< p65 >
간단한 시작 ----> | 반복 | ----> 크고 복잡해진다.
<간단한 상태>  <---------------  <복잡한 상태>
     | 문제만나면 간단한 상태로 돌아간다. |

```

이 부분을 명심해야 겠다.

추가적으로, 코드 추출이 어렵다면 코드 주변을 걷어내는것을 추천한다고 한다.

문제의 위치를 더 빨리 코드에서 잡아내는 방법을 갖는다면, 생산성을 높일수 있는 최선의 방법이라 말한다.

## 비디오 스트리밍용 HTTP 서버 만들기

> 별거 없다, 프로젝트 생성하고 만들면 된다.
> 내가 중간에 놓칠수있는 부분이 있으므로 빠르게 작성한다.

구조는 다음과 같다.

- HTTP GET: /video

여기서 `createReadStream` 함수를 사용하여 만든다.
말 그대로 `스트리밍 데이터` 로 작업하기 위한 추상적 인터페이스라고 하는데,

보통 대용량 파일 및 데이터 수정 및 변형을 위해 쓰이는 듯 하다.

간단한 예로

```js
process.stdout.write("택스트"); // "택스트"
```

위 처럼 `stdout` 역시 `stream` 으로 작동한다.
[fs.createReadStream 노드 js docs](https://nodejs.org/api/fs.html#fscreatereadstreampath-options)

내용을 살펴보면, `chunk` 는 `The chunk of data` 라고 하는데, `Buffer` 의 모음으로 생각하면 될 것 같다.

`Buffer` 는 `raw binary data` 를 저장한 객체로, 바이트를 저장하고 처리한다.

컴퓨터는 이진수로 처리되며, 실제로 모든 데이터는 이진수이다.
이진수의 숫자를 처리할 수 있다면, 큰 용량을 가진 `data` 를 세분화하여  
청크단위로 묶은후 전송하고, 나중에 순서대로 합치면 되는 방식이다.

무언가를 `download` 할때, `percentage` 가 큰 용량의 `data` 를  
`chunk` 로 묶어서 보내는것으로 생각하면 될것 같다.

이는, `vidoe` 에서도 사용되는 기법이며, 현재 만든 매우 단순한 `application` 에서도 `readStream` 을 사용한후, `pipe` 함수를 통해  
`res` 객체로 보낸것이다.

## 운영환경

```shell

npm install --only=production

```

위의 명령어는 `npm` 에서 운영환경에서만 필요한 종속성을 설치한다.
개발환경에만 필요한 패키지 설치를 방지한다.

> `package.json` 의 `devDependencies` 에 있는 패키지는 설치 안된다는것이다.

지금까지는 굉장히 간단한 내용이다.
